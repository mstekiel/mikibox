
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CrysFiPy under mikibox package &#8212; mikibox 0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Mikibox package" href="mikibox.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mikibox.html" title="Mikibox package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mikibox 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-mikibox.crysfipy.observables">
<span id="crysfipy-under-mikibox-package"></span><h1>CrysFiPy under mikibox package<a class="headerlink" href="#module-mikibox.crysfipy.observables" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mikibox.crysfipy.observables.boltzman_population">
<code class="descclassname">mikibox.crysfipy.observables.</code><code class="descname">boltzman_population</code><span class="sig-paren">(</span><em>energies</em>, <em>temperature</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#boltzman_population"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mikibox.crysfipy.observables.boltzman_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the population of energy levels at given temperature based on the Boltzmann statistic.</p>
<p><span class="math notranslate nohighlight">\(p_i = \frac{1}{Z} e^{-E_i/k_B T}\)</span></p>
<p><span class="math notranslate nohighlight">\(Z = \sum_i e^{-Ei/k_BT}\)</span></p>
<p>One important distinction, is that this function works with eigenvalues (energies) from the whole Hilbert space, as it needs to evaluate <span class="math notranslate nohighlight">\(Z\)</span> on its own. This works well for the total angular momentum Hilbert space, and does care about degeneracies.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>energies <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>List of energy levels in meV units</dd>
<dt>tmperature <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Temperature at which to evaluate the statistic</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>List of occupation probabilities for each energy level.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mikibox.crysfipy.observables.magnetization">
<code class="descclassname">mikibox.crysfipy.observables.</code><code class="descname">magnetization</code><span class="sig-paren">(</span><em>cefion</em>, <em>T</em>, <em>Hfield</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#magnetization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mikibox.crysfipy.observables.magnetization" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnetization of the single ion in the crystal field. Returned value is in <span class="math notranslate nohighlight">\(\mu_B\)</span> units.
<span class="math notranslate nohighlight">\(M_\alpha = g_J \sum_n p_n |&lt;\lambda_n | \hat{J}_\alpha | \lambda_n&gt;|\)</span></p>
</dd></dl>

<dl class="function">
<dt id="mikibox.crysfipy.observables.neutronint">
<code class="descclassname">mikibox.crysfipy.observables.</code><code class="descname">neutronint</code><span class="sig-paren">(</span><em>cefion</em>, <em>T</em>, <em>Q</em>, <em>scheme</em>, <em>Ei=1000000.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#neutronint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mikibox.crysfipy.observables.neutronint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matrix of energies and inelastic neutron scattering spectral weights for all possible transitions at given temperature. The spectral weight is calculated by equation from Enderle book following Stephane Raymond article.</p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(S(\vec{Q},\omega) = N (\gamma r_0)^2 f^2_m(Q) e^{-2W(Q)} \sum_{if} \frac{k_f}{k_i} p_i |&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 \delta(E_i - E_f - \hbar \omega)\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(N (\gamma r_0)^2\)</span> : ignored, acts as units.</div>
<div class="line"><span class="math notranslate nohighlight">\(f^2_m(Q)\)</span> : magnetic form factor, taken from internal tables in <code class="docutils literal notranslate"><span class="pre">mikibox.crysfipy.Ion</span></code> class.</div>
<div class="line"><span class="math notranslate nohighlight">\(e^{-2W(Q)}\)</span> : <span class="math notranslate nohighlight">\(W(Q)\)</span> is the Debye-Waller factor. It is quite problematic, is set to 1 at the moment.</div>
<div class="line"><span class="math notranslate nohighlight">\(\frac{k_f}{k_i}\)</span> : scaling factor calculated from energy, which is used more widely <span class="math notranslate nohighlight">\(\frac{k_f}{k_i} = \sqrt{1-\frac{\Delta E}{E_i}}\)</span>. there is a minus under the square root, because positive energy transfer corresponds to neutron energy loss.</div>
<div class="line"><span class="math notranslate nohighlight">\(p_i\)</span> : Boltzmann population factor.</div>
<div class="line"><span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2\)</span> : matrix elements, exact description depends on <code class="docutils literal notranslate"><span class="pre">Q</span></code>, see below.</div>
</div>
<p>The intensities are evaluated based on the <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2\)</span> matrix elements, which form a matrix <span class="math notranslate nohighlight">\(|J_\perp|^2\)</span>.
Two main cases are implemented and encoded in the <code class="xref py py-data docutils literal notranslate"><span class="pre">Q</span></code> parameter.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>cefion <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.reion.CEFion</span></code> </span></dt>
<dd>Rare-earth ion in the crystal field</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Temperature in <em>K</em></dd>
<dt>Q <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>List of Q vectors used to evaluate the spectral weight</dd>
<dt>scheme <span class="classifier-delimiter">:</span> <span class="classifier">‘powder’, ‘single-crystal’:</span></dt>
<dd><p class="first">Scheme according to which <span class="math notranslate nohighlight">\(|J_\perp|^2\)</span> is calculated.</p>
<ul class="last simple">
<li>powder :  <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 = 2/3\sum_\alpha |&lt;\lambda_f|J_\alpha|\lambda_i&gt;|^2\)</span> (default).</li>
<li>(single-crystal : <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 = \sum_\alpha (1-\frac{Q_\alpha}{Q})|&lt;\lambda_f|J_\alpha|\lambda_i&gt;|^2\)</span>. Q is a vector representing a direction in the reciprocal space in respect to which a perpendicular projection of <span class="math notranslate nohighlight">\(J\)</span> will be calculated.</li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>energies <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Array containing energies of the transitions</dd>
<dt>intensities <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Array containing intensities of the transitions</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd><dl class="first last docutils">
<dt>ValueError </dt>
<dd>When an invalid <code class="docutils literal notranslate"><span class="pre">Q</span></code> parameter is chosen, or the dimension of the <code class="docutils literal notranslate"><span class="pre">Q</span></code> vector is not 3.</dd>
<dt>RuntimeWarning</dt>
<dd>When Q=[0,0,0], where the spectral weight is ill defined.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mikibox.crysfipy.observables.susceptibility">
<code class="descclassname">mikibox.crysfipy.observables.</code><code class="descname">susceptibility</code><span class="sig-paren">(</span><em>cefion</em>, <em>temperatures</em>, <em>Hfield_direction</em>, <em>method='perturbation'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#susceptibility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mikibox.crysfipy.observables.susceptibility" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnetic susceptibility at given temperature.</p>
<p>The susceptibility is calculated from the perturbation of the Hamiltonian.</p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\chi_{CEF} = (g_J \mu_B)^2 \left[ \sum_{n,m \neq n}  p_n \frac{1-exp(-\Delta_{m,n}/k_B T)}{\Delta_{m,n}} |&lt;\lambda_m|J|\lambda_n&gt;|^2  +  \frac{1}{k_B T} \sum_{n} p_n |&lt;\lambda_n|J|\lambda_n&gt;|^2 \right]\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(g_J \mu_B\)</span> : Lande factor, Bohr magneton.</div>
<div class="line"><span class="math notranslate nohighlight">\(p_n\)</span> : Ptobabitlity of occupying the energy level <span class="math notranslate nohighlight">\(\lambda_n\)</span> at given temperature.</div>
<div class="line"><span class="math notranslate nohighlight">\(\Delta_{m,n}\)</span> : Energy of transition between the <span class="math notranslate nohighlight">\(\lambda_n\)</span> and <span class="math notranslate nohighlight">\(\lambda_m\)</span> levels.</div>
<div class="line"><span class="math notranslate nohighlight">\(&lt;\lambda_m|J|\lambda_n&gt;\)</span> : J matrix elements.</div>
</div>
<p>In calculations a dangerous trick is used. The <span class="math notranslate nohighlight">\(\frac{1-exp(-\Delta_{m,n}/k_B T)}{\Delta_{m,n}}\)</span> 
factor is computed as a matrix, so naturally it will be divergent on the diagonal, since <span class="math notranslate nohighlight">\(\Delta_{m,n}=0\)</span> there. 
The diagonal is thus replaced with the <span class="math notranslate nohighlight">\(1/k_B T\)</span> values, and the two summations are bundled together. 
This feels dirty, but works so far, even for spin-half systems, which have degenerated ebergy levels.
Maybe because the transitions between degenerated levels are not exactly 0 in the calculations (1e-15 rather).</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>cefion <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.cefion.CEFion</span></code></span></dt>
<dd>Rare-earth ion in crystal field        temperatures : ndarray
Array ocntaining temperatures at which to compute the susceptibility.</dd>
<dt>Hfield_direction:</dt>
<dd>Direction of the applied magnetic field. Value can be arbitrary, it is normalized in the code.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>List of susceptibility values calculated at given temperatures. In the units of <span class="math notranslate nohighlight">\(\mu_B^2\)</span>.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mikibox.crysfipy.observables.thermodynamics">
<code class="descclassname">mikibox.crysfipy.observables.</code><code class="descname">thermodynamics</code><span class="sig-paren">(</span><em>cefion</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#thermodynamics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mikibox.crysfipy.observables.thermodynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the fundamental thermodynamic values as a function of temperature.</p>
<p>These functions are calculated alltogether taking advantage of the fact that thermodynamics can be determined from the partition function <span class="math notranslate nohighlight">\(Z\)</span>, upon differentiation on <span class="math notranslate nohighlight">\(\beta\)</span>, where <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>.</p>
<div class="line-block">
<div class="line">Partition function: <span class="math notranslate nohighlight">\(Z = \sum_n e^{-\beta E_n}\)</span></div>
<div class="line">Average energy: <span class="math notranslate nohighlight">\(\langle E \rangle = - \frac{\partial Z}{\partial \beta}\)</span></div>
<div class="line">Entropy: <span class="math notranslate nohighlight">\(S = k_B ( \ln Z - \beta \frac{\partial Z}{\partial \beta} )\)</span></div>
<div class="line">Heat capacity: <span class="math notranslate nohighlight">\(C_V = k_B \beta^2 \frac{\partial^2 Z}{\partial \beta^2}\)</span></div>
</div>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>cefion <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.CEFion</span></code></span></dt>
<dd>Rare-earth ion in crystal field</dd>
<dt>T <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Temperature</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>Z, E, S CV : The partition function, average energy (internal energy), entropy and heat capacity, respectively.</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="mikibox.html"
                        title="previous chapter">Mikibox package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/crysfipy.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mikibox.html" title="Mikibox package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mikibox 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Michal Stekiel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>