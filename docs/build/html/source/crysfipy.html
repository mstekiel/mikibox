
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>CrysFiPy under mikibox package &#8212; mikibox 0.1.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Mikibox package" href="mikibox.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">mikibox</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="mikibox.html">
  Mikibox package
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  CrysFiPy under mikibox package
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="module-mikibox.crysfipy.observables">
<span id="crysfipy-under-mikibox-package"></span><h1>CrysFiPy under mikibox package<a class="headerlink" href="#module-mikibox.crysfipy.observables" title="Permalink to this headline">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mikibox.crysfipy.observables.boltzman_population">
<span class="sig-prename descclassname"><span class="pre">mikibox.crysfipy.observables.</span></span><span class="sig-name descname"><span class="pre">boltzman_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#boltzman_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mikibox.crysfipy.observables.boltzman_population" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the population of energy levels at given temperature based on the Boltzmann statistic.</p>
<p><span class="math notranslate nohighlight">\(n_i = \frac{1}{Z} e^{-E_i/k_B T}\)</span></p>
<p><span class="math notranslate nohighlight">\(Z = \sum_i e^{-Ei/k_BT}\)</span></p>
<p>One important distinction, is that this function works with eigenvalues (energies) of eigenvectors from the whole Hilbert space, as it needs to evaluate <span class="math notranslate nohighlight">\(Z\)</span> on its own. This works well for the total angular momentum Hilbert space, and does care about degeneracies.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>energies<span class="classifier">array_like</span></dt><dd><p>List of energy levels in meV units</p>
</dd>
<dt>tmperature<span class="classifier">float</span></dt><dd><p>Temperature at which to evaluate the statistic</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>List of occupation probabilities for each energy level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mikibox.crysfipy.observables.magnetization">
<span class="sig-prename descclassname"><span class="pre">mikibox.crysfipy.observables.</span></span><span class="sig-name descname"><span class="pre">magnetization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cefion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hfield</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#magnetization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mikibox.crysfipy.observables.magnetization" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the magnetization of the single ion in the crystal field.
<span class="math notranslate nohighlight">\(M_\alpha = g_J \sum_n p_n &lt;\lambda_n | \hat{J}_\alpha | \lambda_n&gt;\)</span></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mikibox.crysfipy.observables.neutronint">
<span class="sig-prename descclassname"><span class="pre">mikibox.crysfipy.observables.</span></span><span class="sig-name descname"><span class="pre">neutronint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cefion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'powder'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#neutronint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mikibox.crysfipy.observables.neutronint" title="Permalink to this definition">#</a></dt>
<dd><p>Returns matrix of energies and inelastic neutron scattering spectral weights for all possible transitions at given temperature. The spectral weight is calculated by equation from Enderle book following Stephane Raymond article.</p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(S(\vec{Q},\omega) = N (\gamma r_0)^2 f^2_m(Q) e^{-2W(Q)} \sum_{if} \frac{k_f}{k_i} p_i |&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 \delta(E_i - E_f - \hbar \omega)\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(N (\gamma r_0)^2\)</span> : ignored, acts as units.</div>
<div class="line"><span class="math notranslate nohighlight">\(f^2_m(Q)\)</span> : magnetic form factor, taken from internal tables in <code class="docutils literal notranslate"><span class="pre">mikibox.crysfipy.Ion</span></code> class.</div>
<div class="line"><span class="math notranslate nohighlight">\(e^{-2W(Q)}\)</span> : <span class="math notranslate nohighlight">\(W(Q)\)</span> is the Debye-Waller factor. It is quite problematic, is set to 1 at the moment.</div>
<div class="line"><span class="math notranslate nohighlight">\(\frac{k_f}{k_i}\)</span> : scaling factor calculated from energy, which is used more widely <span class="math notranslate nohighlight">\(\frac{k_f}{k_i} = \sqrt{1-\frac{\Delta E}{E_i}}\)</span>. there is a minus under the square root, because positive energy transfer corresponds to neutron energy loss.</div>
<div class="line"><span class="math notranslate nohighlight">\(p_i\)</span> : Boltzmann population factor.</div>
<div class="line"><span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2\)</span> : matrix elements, exact description depends on <code class="docutils literal notranslate"><span class="pre">Q</span></code>, see below.</div>
</div>
<p>The intensities are evaluated based on the <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2\)</span> matrix elements, which form a matrix <span class="math notranslate nohighlight">\(|J_\perp|^2\)</span>.
Two main cases are implemented and encoded in the <code class="xref py py-data docutils literal notranslate"><span class="pre">Q</span></code> parameter.</p>
<dl>
<dt>Parameters:</dt><dd><dl>
<dt>cefion<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.reion.CEFion</span></code> </span></dt><dd><p>Rare-earth ion in the crystal field</p>
</dd>
<dt>T<span class="classifier">float</span></dt><dd><p>Temperature in <em>K</em></p>
</dd>
<dt>Q<span class="classifier">‘powder’ or ndarray, optional</span></dt><dd><p>Scheme according to which <span class="math notranslate nohighlight">\(|J_\perp|^2\)</span> is calculated.</p>
<ul class="simple">
<li><p>powder :  <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 = 2/3\sum_\alpha |&lt;\lambda_f|J_\alpha|\lambda_i&gt;|^2\)</span> (default).</p></li>
<li><p>(3,) float : <span class="math notranslate nohighlight">\(|&lt;\lambda_f|J_\perp|\lambda_i&gt;|^2 = \sum_\alpha (1-\frac{Q_\alpha}{Q})|&lt;\lambda_f|J_\alpha|\lambda_i&gt;|^2\)</span>. Q is a vector representing a direction in the reciprocal space in respect to which a perpendicular projection of <span class="math notranslate nohighlight">\(J\)</span> will be calculated.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>energies<span class="classifier">ndarray</span></dt><dd><p>Array containing energies of the transitions</p>
</dd>
<dt>intensities<span class="classifier">ndarray</span></dt><dd><p>Array containing intensities of the transitions</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError </dt><dd><p>When an invalid <code class="docutils literal notranslate"><span class="pre">Q</span></code> parameter is chosen, or the dimension of the <code class="docutils literal notranslate"><span class="pre">Q</span></code> vector is not 3.</p>
</dd>
<dt>RuntimeWarning</dt><dd><p>When Q=[0,0,0], where the spectral weight is ill defined.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mikibox.crysfipy.observables.susceptibility">
<span class="sig-prename descclassname"><span class="pre">mikibox.crysfipy.observables.</span></span><span class="sig-name descname"><span class="pre">susceptibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cefion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hfield_direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#susceptibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mikibox.crysfipy.observables.susceptibility" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the magnetic susceptibility at given temperature.</p>
<p>The susceptibility is calculated as a numerical derivative of the magnetization. But it seems there are some other smart methods to calculate it, so take a look into these japanese papers.</p>
<dl>
<dt>Parameters:</dt><dd><dl>
<dt>ion<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.reion.CEFion</span></code></span></dt><dd><p>Rare-earth ion in crystal field        T : float
Temperature</p>
</dd>
<dt>Hfield_direction:</dt><dd><p>Direction of the applied magnetic field.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>List of susceptibility values calculated at given temperatures</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mikibox.crysfipy.observables.thermodynamics">
<span class="sig-prename descclassname"><span class="pre">mikibox.crysfipy.observables.</span></span><span class="sig-name descname"><span class="pre">thermodynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cefion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mikibox/crysfipy/observables.html#thermodynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mikibox.crysfipy.observables.thermodynamics" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the fundamental thermodynamic values as a function of temperature.</p>
<p>This is all calculated together taking advantage of the fact that all thermodynamics can be determined from the partition function <span class="math notranslate nohighlight">\(Z\)</span>, upon differentiation on <span class="math notranslate nohighlight">\(\beta\)</span>, where <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>.</p>
<div class="line-block">
<div class="line">Partition function: <span class="math notranslate nohighlight">\(Z = \sum_n e^{-\beta E_n}\)</span></div>
<div class="line">Average energy: <span class="math notranslate nohighlight">\(\langle E \rangle = - \frac{\partial Z}{\partial \beta}\)</span></div>
<div class="line">Entropy: <span class="math notranslate nohighlight">\(S = k_B ( \ln Z - \beta \frac{\partial Z}{\partial \beta} )\)</span></div>
<div class="line">Heat capacity: <span class="math notranslate nohighlight">\(C_V = k_B \beta^2 \frac{\partial^2 Z}{\partial \beta^2}\)</span></div>
</div>
<dl>
<dt>Parameters:</dt><dd><dl>
<dt>cefion<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crysfipy.CEFion</span></code></span></dt><dd><p>Rare-earth ion in crystal field</p>
</dd>
<dt>T<span class="classifier">ndarray</span></dt><dd><p>Temperature</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Z, E, S CV : The partition function, average energy (internal energy), entropy and heat capacity, respectively.</p>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="mikibox.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mikibox package</p>
        </div>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Michal Stekiel.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>